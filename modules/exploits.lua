

local function LightsOut()
	for k, v in pairs( ents.GetAll() ) do
		if R.Entity.GetClass( v ) == "gmod_light" then
			net.Start( "editvariable" )
				net.WriteUInt( R.Entity.EntIndex( v ), 32 )
				net.WriteString( "on" )
				net.WriteString( "0" )
			net.SendToServer()
		elseif R.Entity.GetClass( v ) == "gmod_lamp" then
			net.Start( "editvariable" )
				net.WriteUInt( R.Entity.EntIndex( v ), 32 )
				net.WriteString( "on" )
				net.WriteString( "0" )
			net.SendToServer()
		end
	end
end

local function LightsOn()
	for k, v in pairs( ents.GetAll() ) do
		if R.Entity.GetClass( v ) == "gmod_light" then
			net.Start( "editvariable" )
				net.WriteUInt( R.Entity.EntIndex( v ), 32 )
				net.WriteString( "on" )
				net.WriteString( "1" )
			net.SendToServer()

			net.Start( "editvariable" )
				net.WriteUInt( R.Entity.EntIndex( v ), 32 )
				net.WriteString( "br" )
				net.WriteString( "6" )
			net.SendToServer()

			net.Start( "editvariable" )
				net.WriteUInt( R.Entity.EntIndex( v ), 32 )
				net.WriteString( "sz" )
				net.WriteString( "9999999" )
			net.SendToServer()
		end
	end
end

local function createarena()
    if game.GetIPAddress() ~= "64.52.81.251:27015" then
        debugNotif("IP address copied to clipboard.")
        SetClipboardText("64.52.81.251:27015")
        debugNotif("This exploit is for MutinyRP.")
    else
        debugNotif("Arena Created.")
        net.Start("tarena_createarena")
        net.WriteString("Platforms") -- PUT WHATEVER THE SERVER USES FOR MAPS HERE
        net.WriteString("RPG") -- PUT WHATEVER THE SERVER USES FOR GUNS HERE
        net.WriteInt(32767, 16) -- MIN 0 MAX 32767
        net.WriteInt(0, 32) -- 0 BET MONEY, DOESNT MATTER NOBODY WILL WIN
        net.WriteInt(1, 3)
        net.SendToServer()
    end
end

local function invitearena()
    if game.GetIPAddress() ~= "64.52.81.251:27015" then
        debugNotif("IP address copied to clipboard.")
        SetClipboardText("64.52.81.251:27015")
        debugNotif("This exploit is for MutinyRP.")
    else
        for i = 1, game.MaxPlayers() do
            net.Start("tarena_sendinvite")
            net.WriteUInt(i, 13)
            net.SendToServer()
            debugNotif("Invites Sent to client(s) " .. i)
		end
	end
end

Menu.Func.AddCallback( createarena, "Misc", "MutinyRP", "Create bugged arena")
Menu.Func.AddCallback( invitearena, "Misc", "MutinyRP", "Mass invite to arena")
Menu.Func.AddCallback( LightsOn, "Misc", "Lighting", "Full Bright Lights")
Menu.Func.AddCallback( LightsOut, "Misc", "Lighting", "Lights Out")


local LastTime = 0
Lib.Hook.Add( "Tick", "Ã‘!zQwTVlxnRiOJkgzmTfyJ'Ä‘Â£Æ”Ä»Å³ðŸ˜®lÅ¬{Ä³Æ¡âš~", function() 
	if Menu.Func.GetVar("Misc", "Lighting", "Spam Lights") != "Off" then
		if ( CurTime() - LastTime ) > Menu.Func.GetVar("Misc", "Lighting", "Spam Interval") then
			if Menu.Func.GetVar("Misc", "Lighting", "Spam Lights") == "Lights On" then
				LightsOn()
			else
				LightsOut()
			end
			LastTime = CurTime()
		end

	end
end )

local PlayerAddresses = {}
local AnimStateAddress = {}
function resolveAngle()
	for k, ent in pairs( player.GetAll() ) do
		if ent != LocalPlayer() and IsValid( ent ) and R.Player.Alive( ent ) and !R.Player.InVehicle( ent ) then
			local ang = R.Entity.EyeAngles( ent )

			if Menu.Func.GetVar( "Misc", "Anti-Aim", "Correct Dancing Players" ) then
				if ent != LocalPlayer() then -- cancel dance animations
					R.Player.AnimResetGestureSlot( ent, 5 ) -- 5 = GESTURE_SLOT_VCD
					if engine.ActiveGamemode() == "darkrp" then
						R.Player.AnimResetGestureSlot( ent, 6 ) -- 6 = GESTURE_SLOT_CUSTOM
					end
				end
			end

			-- if !ent:IsBot() and ent != LocalPlayer() then -- print( ent, ang ) end
			-- if true then --Menu.Func.GetVar( "HvH", "Normalize Angles" ) then
			-- 	-- R.Angle.Normalize( ang )

			-- if ( ang.p >= 180 ) then
			-- 	ang.p = 89
			-- elseif ( ang.p == 180 ) then
			-- 	ang.p = 89
			-- end

			-- if ( ang.y > 360 ) then
			-- 	ang.y = ang.y - 360
			-- elseif ( ang.y < -360 ) then
			-- 	ang.y = ang.y + 360
			-- end

			-- if ( ang.r > 89 ) then
			-- 	ang.r = ang.r - 180
			-- elseif ( ang.r < -89 ) then
			-- 	ang.r = ang.r + 180
			-- end

			-- if ( ang.p > 89 ) then
			-- 	ang.p = 89
			-- elseif ( ang.p < -89 ) then
			-- 	ang.p = -89
			-- end

			-- if ( ang.y > 360 ) then
			-- 	ang.y = 360
			-- elseif ( ang.y < -360 ) then
			-- 	ang.y = -360
			-- end

			-- if ( ang.r > 180 ) then
			-- 	ang.r = 180
			-- elseif ( ang.r < -180 ) then
			-- 	ang.r = -180
			-- end

			-- if ang.r != 0 then
			-- 	ang.y = ang.y + ang.r
			-- 	ang.r = 0
			-- end

			-- R.Entity.SetPoseParameter( ent, "aim_pitch", math.Clamp( ang.p, -89, 89 ))
			-- R.Entity.SetPoseParameter( ent, "head_pitch", math.Clamp( ang.p, -89, 89 ))

			-- -- if !PlayerAddresses[ent] then
			-- -- 	PlayerAddresses[ent] = CFunc.GetPlayerAddress( ent )
			-- -- end

			-- -- if ent:GetNW2Float("m_flCurrentFeetYaw") then
			-- -- 	local PlayerAddress = CFunc.GetPlayerAddress( ent )
			-- -- 	local AnimStateAddress = CFunc.ReadQWORD( PlayerAddress + 0x3208, 8 )
			-- -- 	-- CFunc.WriteFloat( AnimStateAddress + 148, ang.y ) -- goal feet yaw
			-- -- 	CFunc.WriteFloat( AnimStateAddress + 152, ent:GetNW2Float("m_flCurrentFeetYaw") ) -- current feet yaw
			-- -- 	CFunc.WriteFloat( AnimStateAddress + 60, ent:GetNW2Float("m_flCurrentFeetYaw") )
			-- -- end

			-- -- R.Entity.SetPoseParameter( ent, "body_yaw", 0 )
			-- -- R.Entity.SetPoseParameter( ent, "aim_yaw", 0 )

			-- R.Player.SetRenderAngles( ent, Angle( 0, ang.y + ang.r, 0 ) )
			-- R.Entity.InvalidateBoneCache( ent )
		end
	end
end

Lib.Hook.Add( "PreDrawOpaqueRenderables", "Ã‘!SðŸ˜¡ðŸ˜‚â˜•ðŸ˜”ÆÃ¶Å—Â¬â˜±'Ä‘Â£Æ”Ä»Å³ðŸ˜®lÅ¬{Ä³Æ¡âš~", resolveAngle )